{"version":3,"file":"static/webpack/static/development/pages/product/[slug].js.4f1c59f2eebc86586e95.hot-update.js","sources":["webpack:///./containers/Products/Products.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport dynamic from \"next/dynamic\";\nimport gql from \"graphql-tag\";\nimport { openModal, closeModal } from \"@redq/reuse-modal\";\nimport ProductCard from \"components/ProductCard/ProductCard\";\nimport {\n  ProductsRow,\n  ProductsCol,\n  ButtonWrapper,\n  LoaderWrapper,\n  LoaderItem,\n  ProductCardWrapper,\n} from \"./Products.style\";\nimport { CURRENCY } from \"helper/constant\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport Button from \"components/Button/Button\";\nimport Loader from \"components/Loader/Loader\";\nimport Placeholder from \"components/Placeholder/Placeholder\";\nimport Fade from \"react-reveal/Fade\";\nimport NoResultFound from \"components/NoResult/NoResult\";\n\nconst QuickView = dynamic(() => import(\"../QuickView/QuickView\"));\n\nconst GET_PRODUCTS = gql`\n  query getProducts(\n    $type: String\n    $text: String\n    $category: String\n    $offset: Int\n    $limit: Int\n  ) {\n    products(\n      type: $type\n      text: $text\n      category: $category\n      offset: $offset\n      limit: $limit\n    ) {\n      items {\n        id\n        title\n        slug\n        unit\n        price\n        salePrice\n        description\n        discountInPercent\n        type\n        image\n        gallery {\n          url\n        }\n        categories {\n          id\n          title\n          slug\n        }\n      }\n      hasMore\n    }\n  }\n`;\n\ntype ProductsProps = {\n  deviceType?: {\n    mobile: boolean;\n    tablet: boolean;\n    desktop: boolean;\n  };\n  type: string;\n  fetchLimit?: number;\n  loadMore?: boolean;\n};\nexport const Products: React.FC<ProductsProps> = ({\n  deviceType,\n  type,\n  fetchLimit = 8,\n  loadMore = true,\n}) => {\n  const router = useRouter();\n  const [loadingMore, toggleLoading] = useState(false);\n  const { data, error, loading, fetchMore } = useQuery(GET_PRODUCTS, {\n    variables: {\n      type: type,\n      text: router.query.text,\n      category: router.query.category,\n      offset: 0,\n      limit: fetchLimit,\n    },\n  });\n\n  // Quick View Modal\n  const handleModalClose = () => {\n    const href = `${router.pathname}`;\n    const as = router.asPath;\n    router.push(href, as, { shallow: true });\n    closeModal();\n  };\n  const handleQuickViewModal = React.useCallback(\n    (modalProps: any, deviceType: any, onModalClose: any) => {\n      if (router.pathname === \"/product/[slug]\") {\n        const as = `/product/${modalProps.slug}`;\n        router.push(router.pathname, as);\n        return;\n      }\n      openModal({\n        show: true,\n        overlayClassName: \"quick-view-overlay\",\n        closeOnClickOutside: false,\n        component: QuickView,\n        componentProps: { modalProps, deviceType, onModalClose },\n        closeComponent: \"div\",\n        config: {\n          enableResizing: false,\n          disableDragging: true,\n          className: \"quick-view-modal\",\n          width: 900,\n          y: 30,\n          height: \"auto\",\n          transition: {\n            mass: 1,\n            tension: 0,\n            friction: 0,\n          },\n        },\n      });\n      const href = `${router.pathname}?${modalProps.slug}`;\n      const as = `/product/${modalProps.slug}`;\n      router.push(href, as, { shallow: true });\n    },\n    []\n  );\n\n  if (loading) {\n    return (\n      <LoaderWrapper>\n        <LoaderItem>\n          <Placeholder />\n        </LoaderItem>\n        <LoaderItem>\n          <Placeholder />\n        </LoaderItem>\n        <LoaderItem>\n          <Placeholder />\n        </LoaderItem>\n      </LoaderWrapper>\n    );\n  }\n\n  if (error) return <div>{error.message}</div>;\n  if (!data || !data.products || data.products.items.length === 0) {\n    return <NoResultFound />;\n  }\n  const handleLoadMore = () => {\n    toggleLoading(true);\n    fetchMore({\n      variables: {\n        offset: Number(data.products.items.length),\n        limit: fetchLimit,\n      },\n      updateQuery: (prev, { fetchMoreResult }) => {\n        toggleLoading(false);\n        if (!fetchMoreResult) {\n          return prev;\n        }\n        return {\n          products: {\n            __typename: prev.products.__typename,\n            items: [...prev.products.items, ...fetchMoreResult.products.items],\n            hasMore: fetchMoreResult.products.hasMore,\n          },\n        };\n      },\n    });\n  };\n\n  return (\n    <>\n      <ProductsRow>\n        {data.products.items.map((item: any, index: number) => (\n          <ProductsCol key={index}>\n            <ProductCardWrapper>\n              <Fade\n                duration={800}\n                delay={index * 10}\n                style={{ height: \"100%\" }}\n              >\n                <ProductCard\n                  title={item.title}\n                  description={item.description}\n                  image={item.image}\n                  weight={item.unit}\n                  currency={CURRENCY}\n                  price={item.price}\n                  salePrice={item.salePrice}\n                  discountInPercent={item.discountInPercent}\n                  data={item}\n                  deviceType={deviceType}\n                  onClick={() =>\n                    handleQuickViewModal(item, deviceType, handleModalClose)\n                  }\n                />\n              </Fade>\n            </ProductCardWrapper>\n          </ProductsCol>\n        ))}\n      </ProductsRow>\n      {loadMore && data.products.hasMore && (\n        <ButtonWrapper>\n          <Button\n            onClick={handleLoadMore}\n            title=\"Load More\"\n            intlButtonId=\"loadMoreBtn\"\n            size=\"small\"\n            isLoading={loadingMore}\n            loader={<Loader color=\"#fed700\" />}\n            style={{\n              minWidth: 135,\n              backgroundColor: \"#ffffff\",\n              border: \"1px solid #f1f1f1\",\n              color: \"#fed700\",\n            }}\n          />\n        </ButtonWrapper>\n      )}\n    </>\n  );\n};\nexport default Products;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAkDA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AACA;AADA;AAIA;AACA;AACA;AACA;AACA;AACA;AALA;AADA;AAHA;AAAA;AAAA;AAAA;AACA;AACA;AAYA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAPA;AAPA;AAqBA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AADA;AAOA;AAjBA;AAmBA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AARA;AA6BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBA;AACA;;;;A","sourceRoot":""}